(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[109],{"371780c9695baf2962b9":function(e,t,n){var i=n("bc6eea8809805f106782");"string"==typeof i&&(i=[[e.i,i,""]]);var a={hmr:!0,transform:void 0};n("1e4534d1d62a11482e97")(i,a);i.locals&&(e.exports=i.locals)},bc6eea8809805f106782:function(e,t,n){(t=e.exports=n("c138e55a31f3f8960e99")(!1)).push([e.i,".node_modules--msteams-bridges-components-collaborative-web-content-dist-es-src-collaborative-web-content-renderer__collaborativeWebContentFlexWrapper--Rqc89 {\n  display: flex;\n  width: 100%;\n  max-width: 56vw;\n  flex-direction: column;\n  min-height: 75rem;\n  overflow: auto;\n  margin-top: 1.4rem; }\n",""]),t.locals={collaborativeWebContentFlexWrapper:"node_modules--msteams-bridges-components-collaborative-web-content-dist-es-src-collaborative-web-content-renderer__collaborativeWebContentFlexWrapper--Rqc89"}},da5765f34bfda4415f64:function(e,t,n){"use strict";function i(e,t){var n=Object.keys(e).filter(function(n){return e[n]===t}).map(function(t){return e[t]});return n.length>0?n[0]:void 0}n.d(t,"a",function(){return i})},f9942ffeb37897ccb07d:function(e,t,n){"use strict";n.r(t);var i,a,o,r,s=n("275976081ce1abf67779");!function(e){e.web="web",e.desktop="desktop",e.rigel="rigel"}(i||(i={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel"}(a||(a={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(o||(o={})),function(e){e.card="card",e.deepLink="deepLink",e.contentBubble="contentBubble",e.messageExtension="messageExtension",e.tab="tab",e.shareToOutlook="shareToOutlook"}(r||(r={}));var l,u=n("64328bb588b46459132d"),c={teamSitePath:"teamSitePath",teamSiteDomain:"teamSiteDomain",glassjarBaseUrl:"glassjarBaseUrl"},d="{teamSiteDomain}",f="{teamSitePath}",h="{glassjarBaseUrl}",p={initialize:"initialize",getContext:"getContext",navigateCrossDomain:"navigateCrossDomain",loadingCallback:"loadingCallback",tokenRetrievalCallback:"tokenRetrievalCallback",shareDeepLink:"shareDeepLink",openFilePreview:"openFilePreview",executeDeepLink:"executeDeepLink",getTabInstances:"getTabInstances",getMruTabInstances:"getMruTabInstances",getUserJoinedTeams:"getUserJoinedTeams",getChatMembers:"getChatMembers",toggleIncomingClientAudio:"toggleIncomingClientAudio",authentication:{getAuthToken:"authentication.getAuthToken",getUser:"authentication.getUser",allowWindowOpen:"authentication.allowWindowOpen",authenticate:"authentication.authenticate",authenticateSuccess:"authentication.authenticate.success",authenticateFailure:"authentication.authenticate.failure"},tasks:{startTask:"tasks.startTask",updateTask:"tasks.updateTask",completeTask:"tasks.completeTask",submitTask:"tasks.submitTask"},conversations:{openConversation:"conversations.openConversation",closeConversation:"conversations.closeConversation"},closeConversation:"closeConversation",startConversation:"startConversation",appInitialization:{appLoaded:"appInitialization.appLoaded",success:"appInitialization.success",failure:"appInitialization.failure"},settings:{setValidityState:"settings.setValidityState",setSettings:"settings.setSettings",saveSettings:"settings.save",getSettings:"settings.getSettings",save:{success:"settings.save.success",failure:"settings.save.failure"}}};!function(e){e.AuthFailed="AuthFailed",e.Timeout="Timeout",e.Other="Other"}(l||(l={}));var v,m={resourceDomainParameter:"{resourceDomain}",validResourcePattern:"^((https|api)://{resourceDomain})"},g=["com.example.microsoftteamstabs.test","e65961b5-7174-44a2-bcac-afd6084d20bf","b58eb5fd-50e3-4ebd-9c1c-8f26e98d5749","db5e5970-212f-477f-a3fc-2227dc7782bf","bb82879b-d5fd-4ee0-af31-ab46da16f71a","2965d9af-530f-425f-806b-94c93c76328f","0001ca17-5f4a-47a3-912f-97aaa1b6fd76"],b=function(e){var t=e.sdkHost,n=e.contentUrl,i=e.frameContext,a=e.appDefinition,o=e.createWebview,r=e.title,l=s.useRef(null);return s.useEffect(function(){Object(u.__awaiter)(void 0,void 0,void 0,function(){return Object(u.__generator)(this,function(e){switch(e.label){case 0:return[4,o().then(function(){return Object(u.__awaiter)(void 0,void 0,void 0,function(){return Object(u.__generator)(this,function(e){switch(e.label){case 0:return[4,t.setFrameAndLoadOrigin(l.current,n,a)];case 1:return e.sent(),[2]}})})})];case 1:return e.sent(),[2]}})})},[o,t,l,n,i,a]),s.createElement(w,{webviewRef:l,title:r})},w=function(e){var t=e.webviewRef,n=e.title;return s.createElement("webview",{ref:t,allowpopups:"true",style:{height:"100%",width:"100%",border:0,flex:1},"data-tid":"app-host-webview",title:n})},k=function(e){var t=e.sdkHost,n=e.contentUrl,i=e.frameContext,a=e.appDefinition,o=e.title,r=s.useRef(null);return s.useEffect(function(){Object(u.__awaiter)(void 0,void 0,void 0,function(){return Object(u.__generator)(this,function(e){switch(e.label){case 0:return[4,t.setFrameAndLoadOrigin(r.current,n,a)];case 1:return e.sent(),[2]}})})},[t,r,n,i,a]),s.createElement("iframe",{"data-tid":"app-host-iframe",ref:r,style:Object(u.__assign)({},{height:"100%",width:"100%",border:0,flex:1}),sandbox:"allow-forms allow-popups allow-popups-to-escape-sandbox allow-pointer-lock allow-scripts allow-same-origin allow-modals",title:o})},y=n("94a755535d135f12850c");!function(e){e.iframe="iframe",e.webview="webview"}(v||(v={}));var C=n("bf92262120ebdf79ce6a");var x,D=function(e){return new URL(e).href},T=function(e){return e&&new URL(e).hostname},O=function(e,t,n){return void 0!==t&&void 0!==e&&function(e,t){if(-1!==e.indexOf("local.teams.office.com"))return!0;for(var n=D(e),i=0,a=Object(y.uniqBy)(t,function(e){return e.toLowerCase()});i<a.length;i++){for(var o="",r=a[i].split("."),s=0;s<r.length;s++)o+=(s>0?"[.]":"")+r[s].replace("*","[^/^.]+");var l=new RegExp("^https://"+o+"((/|\\?).*)?$","i");if(e.match(l)||n.match(l))return!0}return!1}(I(t,n),A(e,n))},A=function(e,t){var n=e.validDomains?Object(y.cloneDeep)(e.validDomains):[];return e.galleryTabs&&n.push.apply(n,Object(y.map)(e.galleryTabs,function(e){return T(I(e.configurationUrl,t))})),e.staticTabs&&n.push.apply(n,Object(y.map)(e.staticTabs,function(e){return e.contentUrl?T(I(e.contentUrl,t)):null})),Object(y.remove)(n,function(e){return!e}),Object(y.uniqBy)(n,function(e){return e.toLowerCase()})},M=function(e){return e&&-1!==g.indexOf(e.toLowerCase())},S=function(e,t){return M(e)||!Object(y.isEmpty)(t)},j=function(e,t,n,i){var a;if(!n||n.isFullTrustApp||M(n.appId))return Promise.resolve(t);if(null===(a=null==n?void 0:n.webApplicationInfo)||void 0===a?void 0:a.resource){var o=F(n,i);return o&&W(o,e)?Promise.resolve([o]):Promise.reject("App resource defined in manifest and iframe origin do not match")}return Promise.reject("App webApplicationInfo or resource not defined in manifest")},I=function(e,t){if(t){if(t.glassjarBaseUrl&&e.includes(h)){var n=new RegExp(h,"g");e=e.replace(n,t.glassjarBaseUrl)}if(t.teamSiteDomain&&e.includes(d)){var i=new RegExp(d,"g");e=e.replace(i,t.teamSiteDomain)}if(t.teamSitePath&&e.includes(f)){i=new RegExp(f,"g");e=e.replace(i,t.teamSitePath)}return e}return e},F=function(e,t){var n,i;return(null===(n=e.webApplicationInfo)||void 0===n?void 0:n.resource)&&I(null===(i=e.webApplicationInfo)||void 0===i?void 0:i.resource,t)},W=function(e,t){if(e&&t){if(e===t)return!0;var n=T(t),i=m.validResourcePattern.replace(m.resourceDomainParameter,n);return new RegExp(i,"i").test(e)}return!1},U=function(){function e(e){this.listeners={},this.element=e}return e.prototype.addListener=function(e,t){this.element&&(this.removeListener(e),this.element.addEventListener(e,t),this.listeners[e]=t)},e.prototype.removeListener=function(e){this.element&&this.listeners[e]&&(this.element.removeEventListener(e,this.listeners[e]),delete this.listeners[e])},e.prototype.removeAllListeners=function(){for(var e=0,t=Object.keys(this.listeners);e<t.length;e++){var n=t[e];this.removeListener(n)}},e}();!function(e){e.InvalidAuthUrl="InvalidAuthUrl",e.CancelledByUser="CancelledByUser",e.UnsupportedFrameContext="UnsupportedFrameContext",e.AppDefinitionUnavailable="AppDefinitionUnavailable",e.Other="Other"}(x||(x={}));var P,H,L,_,R=function(){function e(e,t,n,i,o,r,s){var l=this;if(this.hostWindow=e,this.hostClientType=t,this.doneHandler=i,this.appDefinition=o,this.appContext=r,this.authenticationService=s,this.authHandlers={},this.initialized=!1,this.initialize=function(){return l.initialized=!0,[a.authentication,l.hostClientType]},this.handleAuthenticateSuccess=function(e,t){l.initialized&&e&&(l.closeWindow(),l.stopAuthWindowMonitor(),l.doneHandler(!0,t))},this.handleAuthenticateFailure=function(e,t){l.initialized&&e&&(l.closeWindow(),l.stopAuthWindowMonitor(),l.doneHandler(!1,t,x.Other))},this.removeMessageHandler=function(e){delete l.authHandlers[e]},this.onAuthMessageReceived=function(e){if(l.authWindow&&l.authWindow===e.source){var t=e.origin;t!==l.authOrigin&&O(l.appDefinition,t)&&(l.authOrigin=e.origin),l.authOrigin===t&&l.handleMessage(e)}},this.setupAuthMessageHandlers=function(){l.addMessageHandler(p.initialize,l.initialize),l.addMessageHandler(p.authentication.authenticateSuccess,l.handleAuthenticateSuccess),l.addMessageHandler(p.authentication.authenticateFailure,l.handleAuthenticateFailure),l.appContext&&l.authenticationService&&l.addMessageHandler(p.getContext,l.getContext(l.hostClientType,l.appContext,l.authenticationService))},O(o,n)){var u=this.hostWindow.opener.globalWindow;this.authWindow=u.open(n,"appAuthWindow",void 0),this.authWindow&&(this.globalWindowEventListener=new U(u),this.globalWindowEventListener.addListener("message",this.onAuthMessageReceived),this.startAuthWindowMonitor(),this.setupAuthMessageHandlers())}else i(!1,"Auth url is not valid",x.InvalidAuthUrl)}return e.prototype.isWindowOpen=function(){return!!this.authWindow&&!this.authWindow.closed},e.prototype.closeWindow=function(){var e;this.globalWindowEventListener&&this.globalWindowEventListener.removeListener("message"),null===(e=this.authWindow)||void 0===e||e.close()},e.prototype.addMessageHandler=function(e,t){this.authHandlers[e]=t},e.prototype.sendResponseMessage=function(e,t){if(this.authOrigin){var n={id:e,args:t,origin:this.authOrigin};this.postMessage(n)}},e.prototype.sendRequestMessage=function(e,t){if(this.authOrigin){var n={func:e,args:t};this.postMessage(n)}},e.prototype.startAuthWindowMonitor=function(){var e=this;this.stopAuthWindowMonitor(),this.authWindowMonitor=this.hostWindow.setInterval(function(){e.authWindowInterval()},100)},e.prototype.authWindowInterval=function(){this.isWindowOpen()?this.sendRequestMessage("ping"):(this.doneHandler(!1,"CancelledByUser",x.CancelledByUser),this.stopAuthWindowMonitor())},e.prototype.stopAuthWindowMonitor=function(){this.authWindowMonitor&&(this.hostWindow.clearInterval(this.authWindowMonitor),this.authWindowMonitor=void 0)},e.prototype.handleMessage=function(e){var t=this,n=e.data,i=this.authHandlers[n.func];if(i){var a=n.args;(a=n.args&&Array.isArray(n.args)?Object(y.cloneDeep)(n.args):[]).unshift(e);var o=i.apply(this,a);if(o){var r=function(e){t.processHandlerResultHelper(n,e)};"object"==typeof o&&"then"in o&&"function"==typeof o.then?o.then(r):r(o)}}},e.prototype.processHandlerResultHelper=function(e,t){var n=Array.isArray(t)?t:[t];this.sendResponseMessage(e.id,n)},e.prototype.postMessage=function(e){var t;this.authOrigin&&(null===(t=this.authWindow)||void 0===t||t.postMessage(e,this.authOrigin))},e.prototype.getContext=function(e,t,n){return function(){return null==n?void 0:n.getUser().then(function(n){var i,a,o,r,s;return Object(u.__assign)({hostClientType:e,loginHint:(null===(i=null==n?void 0:n.profile)||void 0===i?void 0:i.upn)||"",tid:(null===(a=null==n?void 0:n.profile)||void 0===a?void 0:a.tid)||"",upn:(null===(o=null==n?void 0:n.profile)||void 0===o?void 0:o.upn)||"",userObjectId:(null===(r=null==n?void 0:n.profile)||void 0===r?void 0:r.oid)||"",userPrincipalName:(null===(s=null==n?void 0:n.profile)||void 0===s?void 0:s.upn)||""},t)})}},e}(),E=function(){function e(e,t,n,i){var o=this;this.hostWindow=e,this.hostClientType=t,this.frameContext=n,this.telemetryService=i,this.handlers={},this.initialized=!1,this.removeMessageHandler=function(e){delete o.handlers[e]},this.initializeAuthenticationContext=function(e){var t;o.contextPromise=null===(t=o.authenticationService)||void 0===t?void 0:t.getUser().then(function(t){var n,i,a,r,s;return Object(u.__assign)(Object(u.__assign)(Object(u.__assign)({},o.getDefaultContext()),{loginHint:(null===(n=null==t?void 0:t.profile)||void 0===n?void 0:n.upn)||"",tid:(null===(i=null==t?void 0:t.profile)||void 0===i?void 0:i.tid)||"",upn:(null===(a=null==t?void 0:t.profile)||void 0===a?void 0:a.upn)||"",userObjectId:(null===(r=null==t?void 0:t.profile)||void 0===r?void 0:r.oid)||"",userPrincipalName:(null===(s=null==t?void 0:t.profile)||void 0===s?void 0:s.upn)||""}),e)})},this.initialize=function(e){return o.initialized=!0,[o.getFrameContext(),o.hostClientType]},this.getContext=function(){var e,t,n=null===(e=o.telemetryService)||void 0===e?void 0:e.createScenario("getContext",null===(t=o.appDefinition)||void 0===t?void 0:t.appId);try{return o.isInitialized()&&o.contextPromise?(null==n||n.stop(),o.contextPromise):(null==n||n.fail("SDK context is not initialized"),Promise.reject("SDK context is not initialized"))}catch(e){return null==n||n.fail("getContext Failed"),Promise.resolve({})}},this.handleNavigateCrossDomain=function(e,t){return o.load(t)},this.handleGetAuthToken=function(e,t){var n,i,a=null===(n=o.telemetryService)||void 0===n?void 0:n.createScenario("getAuthToken",null===(i=o.appDefinition)||void 0===i?void 0:i.appId);return o.getTabContext().then(function(n){return j(e.origin,t,o.appDefinition,n).then(function(e){return o.authenticationService?o.authenticationService.acquireToken(e[0]).then(function(e){return null==a||a.stop(),[!0,e.token]}):Promise.reject("No authentication service is available")})}).catch(function(){return null==a||a.fail("GetAuthToken failed"),[!1,"GetAuthToken failed"]})},this.handleAuthenticate=function(e,t){var n,i,r=null===(n=o.telemetryService)||void 0===n?void 0:n.createScenario("authenticationAuthenticate",null===(i=o.appDefinition)||void 0===i?void 0:i.appId),s=e.data.id,l=function(e,t,n){o.frame&&o.sendResponseMessage(o.frame,s,[e,t]),e?null==r||r.stop():null==r||r.fail("auth failed with reason "+n)};o.isInFrameContext(a.content,a.sidePanel,a.remove,a.settings,a.task)?o.appDefinition?new R(o.hostWindow,o.hostClientType,t,l,o.appDefinition).addMessageHandler(p.getContext,o.getContext):l(!1,"App definition not available",x.AppDefinitionUnavailable):l(!1,"Authentication API not supported in "+o.frameContext+" context",x.UnsupportedFrameContext)},this.handleOpenFilePreview=function(e,t,n,i,a,r,s,l,u,c,d,f){o.appDefinition&&(o.appDefinition.isFullTrustApp||S(o.appDefinition.appId,o.appDefinition.tenantId))&&o.hostWindow.open(r)},this.urlToLoad=function(e){return e},this.handleGetUser=function(){var e,t,n=null===(e=o.telemetryService)||void 0===e?void 0:e.createScenario("getUser",null===(t=o.appDefinition)||void 0===t?void 0:t.appId);return(o.authenticationService?Promise.resolve(o.authenticationService):Promise.reject("No authentication service is available")).then(function(e){return e.getUser().then(function(e){return e?(null==n||n.stop(),[!0,e.profile]):Promise.reject("Failed to fetch the user profile")}).catch(function(){return Promise.reject("Failed to fetch the user profile")})}).catch(function(){return null==n||n.fail("GetUser failed"),[!1,"GetUser failed"]})},this.isPlaceholderInUrlPart=function(e){return e===c.teamSiteDomain||e===c.teamSitePath||e===c.glassjarBaseUrl},this.getTabContext=function(){return o.contextPromise?o.contextPromise.then(function(e){return e}).catch(function(){return o.getDefaultContext()}):Promise.resolve(o.getDefaultContext())},this.getDefaultContext=function(){return{hostClientType:o.hostClientType,frameContext:o.getFrameContext()}},this.setupMessageHandlers=function(){o.addMessageHandler(p.getContext,o.getContext),o.addMessageHandler(p.navigateCrossDomain,o.handleNavigateCrossDomain),o.addMessageHandler(p.authentication.getAuthToken,o.handleGetAuthToken),o.addMessageHandler(p.authentication.getUser,o.handleGetUser),o.addMessageHandler(p.authentication.authenticate,o.handleAuthenticate),o.addMessageHandler(p.openFilePreview,o.handleOpenFilePreview)},this.setupMessageHandlers()}return e.prototype.isInitialized=function(){return this.initialized},e.prototype.addMessageHandler=function(e,t){this.handlers[e]=t},e.prototype.setFrameAndLoadOrigin=function(e,t,n){return this.appDefinition=n,this.frame=e,this.load(t)},e.prototype.sendRequestMessage=function(e,t){if(this.origin&&this.frame){var n={func:e,args:t};this.postMessage(this.frame,n)}},e.prototype.sendResponseMessage=function(e,t,n){if(this.origin){var i={id:t,args:n,origin:this.origin};this.postMessage(e,i)}},e.prototype.getFrameContext=function(){return this.frameContext},e.prototype.setAuthenticationService=function(e){this.authenticationService=e},e.prototype.postMessageToFrame=function(e){if(!this.frame)throw new Error("could not post message, frame is not defined");this.postMessage(this.frame,e)},e.prototype.handleMessage=function(e){var t=this,n=e.data,i=this.handlers[n.func||n.name];if(i){e.sendAsyncResponse=function(e){t.sendRequestMessage(e.func,e.args)},e.postMessageToFrame=function(e){t.postMessageToFrame(e)};var a=n.args;(a=n.args&&Array.isArray(n.args)?Object(y.cloneDeep)(n.args):[]).unshift(e);var o=i.apply(this,a);if(o){var r=function(e){t.processHandlerResultHelper(n,e)};"object"==typeof o&&"then"in o&&"function"==typeof o.then?o.then(r):r(o)}}},e.prototype.load=function(e){var t=this;return this.getTabContext().then(function(n){if(O(t.appDefinition,e,n)&&t.frame){var i=t.formatTabUrl(e,n);return t.origin=i,t.frame.src=D(t.urlToLoad(i)),Promise.resolve()}return Promise.reject("Url is invalid")})},e.prototype.formatTabUrl=function(e,t){if(t)for(var n in t)if(t.hasOwnProperty(n)){var i=new RegExp("{"+n+"}","g");e=this.isPlaceholderInUrlPart(n)?e.replace(i,t[n]):e.replace(i,encodeURIComponent(t[n]))}return e},e.prototype.processHandlerResultHelper=function(e,t){var n,i,a=e.id;if("object"==typeof t&&"target"in t){var o=t;n=o.target,i=o.args,void 0!==o.id&&null!==o.id&&(a=o.id)}else n=this.frame,i=Array.isArray(t)?t:[t];n&&this.sendResponseMessage(n,a,i)},e.prototype.isInFrameContext=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.getFrameContext();if(n&&e)for(var i in e)if(n===e[i])return!0;return!1},e}(),N=function(e){function t(t,n,i,a){var o=e.call(this,t,n,i,a)||this;return o.onMessageReceived=function(e){if("webview-to-main-renderer-postmessage"===(e&&e.channel)){var t=e.target;if(o.frame===t){var n=e.args&&e.args[0];if(n){var i=e.args[1];n!==o.origin&&O(o.appDefinition,n)&&(o.origin=n),o.origin===n&&(i&&"iframeLoaded"===i.func||o.handleMessage({origin:n,data:i}))}}}},o.postMessage=function(e,t){e.send("main-renderer-to-webview-postmessage",t)},o.urlToLoad=function(e){return"https://teams.microsoft.com/iframe-container.html#iframeurl="+encodeURIComponent(e)+"&skipDomainValidation=true&multiwindow=true"},o}return Object(u.__extends)(t,e),t.prototype.setFrameAndLoadOrigin=function(t,n,i){return this.webviewEventListener=new U(t),this.webviewEventListener.addListener("ipc-message",this.onMessageReceived),e.prototype.setFrameAndLoadOrigin.call(this,t,n,i)},t}(E),z=function(e){function t(t,n,a,o){var r=e.call(this,t,n,a,o)||this;return r.onMessageReceived=function(e){if(r.frame&&r.frame.contentWindow===e.source){var t=e.origin;t!==r.origin&&O(r.appDefinition,t)&&(r.origin=e.origin),r.origin===t&&r.handleMessage(e)}},r.postMessage=function(e,t){r.origin&&(r.hostClientType===i.desktop?r.hostWindow.proxyPostMessage(e,t,r.origin):e.contentWindow&&e.contentWindow.postMessage(t,r.origin))},r.hostEventListener=new U(t),r.hostEventListener.addListener("message",r.onMessageReceived),r}return Object(u.__extends)(t,e),t}(E),B=function(e){var t,n,a,o=(t=e.hostWindow,n=e.hostType,a=e.frameContext,s.useMemo(function(){return n===v.webview?new N(t,i.desktop,a):new z(t,i.web,a)},[t,n,a]));return o.setAuthenticationService(e.authenticationService),o.initializeAuthenticationContext(e.appContext),o.addMessageHandler(p.initialize,o.initialize),e.messageHandlers&&Object(y.each)(e.messageHandlers,function(e){o&&o.addMessageHandler(e.messageName,e.handler)}),e.hostType===v.webview?s.createElement(b,Object(u.__assign)({},e,{sdkHost:o})):s.createElement(k,Object(u.__assign)({},e,{sdkHost:o}))},q=n("371780c9695baf2962b9"),V=(n("9a00f2d9c00b85180c45"),function(e,t){return e.osLocaleInfo&&{platform:t,regionalFormat:e.osLocaleInfo.regionalFormat,shortDate:e.osLocaleInfo.date.shortDate,longDate:e.osLocaleInfo.date.longDate,shortTime:e.osLocaleInfo.date.shortTime,longTime:e.osLocaleInfo.date.longDate}}),G=n("8785381b663d2a54bd88");!function(e){e.Windows="windows",e.Mac="mac",e.Linux="linux",e.ChromeOS="chromeos",e.Android="android",e.IOS="ios",e.WindowsPhone="windowsphone",e.Unknown="unknown"}(P||(P={})),function(e){e.Default="default",e.DefaultV2="defaultV2",e.DefaultTfl="tfl-default",e.Dark="dark",e.DarkV2="darkV2",e.DarkTfl="tfl-dark",e.HighContrast="contrast"}(H||(H={})),function(e){e.Default="0",e.Dark="1",e.HighContrast="2",e.DefaultV2="3",e.DarkV2="4",e.DefaultTfl="5",e.DarkTfl="6"}(L||(L={})),function(e){e.HighContrast="#FFFFFF_#000000_#FFFF00"}(_||(_={}));var J=n("3c106641750cf9daeafe"),K=n("12526da03c3b7e6cee51"),$=n("de37865275a329b0e71c"),Q=n("eb359d7693dd06453be6"),X=n("56e93fab5efcffbf24fb"),Y=n("da5765f34bfda4415f64"),Z=s.memo;var ee=function(){var e=Object(Q.b)(X.a.Host).theme,t=function(e){try{switch(e.state.getSearchState().t){case L.Default:return H.Default;case L.Dark:return H.Dark;case L.HighContrast:return H.HighContrast;default:return}}catch(e){return}}(Object(K.b)().routingServices),n=Object($.a)("ThemeProvider"),i=t||Object(Y.a)(H,e);i||(n.log("The call to useTheme() failed to resolve the theme from provided string "+e+". Falling back to "+H.Default+"."),i=H.Default);var a=J.a.isRtl();return n.log("The call to useTheme() returned { theme: "+i+", rtl: "+a+" }"),{theme:i,rtl:a}};Z(function(e){return e.children(ee())}).displayName="ThemeProvider";var te=n("627f93080be94c050f99");var ne=s.memo,ie=s.createContext(void 0);ie.displayName="ViewContext",ne(function(e){var t=e.children,n=e.updateEntityState,i=e.entity,a=Object(u.__rest)(e,["children","updateEntityState","entity"]),o=Object($.a)(ie.displayName),r=s.useCallback(function(e){return n(i,e)},[i,n]),l=s.useCallback(function(e,t){return function(e,t,n,i){var a={};if(e.type===t&&e.action===n){var o=e.options;if(o&&"string"==typeof o)try{a=JSON.parse(o)}catch(e){i.warn("Entity options are in unexpected format. Expected a valid stringified JSON object but instead received: "+o+".")}}else i.warn("Entity options are (incorrectly) being asked for type and action that do not pertain to the entity.");return a}(i,e,t,o)},[i,o]);return s.createElement(ie.Provider,{value:Object(te.a)(Object(u.__assign)(Object(u.__assign)({},a),{entity:i,updateEntityState:r,getEntityOptions:l}),y.isEqual)},t)}).displayName="ViewContextProvider";ie.Consumer;var ae=function(e,t){var n=s.useContext(G.b),i=ee().theme,a=t?t(i):i,o=Object(Q.b)(X.a.Metadata).ring,r=Object(Q.b)(X.a.Sdk),l=r.osLocaleInfoPlatformType,c=r.enableOsLocaleInfoInContext,d=Object(Q.b)(X.a.Platform).localeCode||void 0,f=s.useContext(ie),h=s.useMemo(function(){return function(e){var t,n;return(null===(n=null===(t=null==e?void 0:e.entities)||void 0===t?void 0:t.primaryEntity)||void 0===n?void 0:n.type)===C.c.calls}(f)?function(e){if(e)return btoa("0#"+e+"#0")}(null==e?void 0:e.chatId):void 0},[f,e]),p=Object(Q.b)(X.a.Extensibility).platformAppGlassJarBaseUrl,v=c&&l?{osLocaleInfo:V(n,l)}:{};return s.useMemo(function(){return Object(u.__assign)(Object(u.__assign)({theme:a,locale:d,ringId:(null==o?void 0:o.id)?o.id:void 0,meetingId:h,isMultiWindow:!0,glassjarBaseUrl:p},v),e)},[a,d,o,h,p,v,e])},oe={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authenticationToken"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationToken"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resource"},value:{kind:"Variable",name:{kind:"Name",value:"resource"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"token"},arguments:[],directives:[]}]}}]}}]},re={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authenticationUsers"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filter"}},type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserFilter"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationUsers"},arguments:[{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"Variable",name:{kind:"Name",value:"filter"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isAuthenticated"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profile"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tenantId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"upn"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"puid"},arguments:[],directives:[]}]}}]}}]}}]},se=function(e){return e?encodeURIComponent(e):""},le=function(e){var t,n,i,o=ae(e.appContext);return o.theme=e.urlParams.currentTheme,s.createElement("div",{className:q.collaborativeWebContentFlexWrapper},s.createElement(B,{hostWindow:e.hostWindow,appDefinition:e.appDefinition,contentUrl:(n=e.urlParams,i=e.contentUrl,i.replace("{locale}",se(n.ui)).replace("{objectId}",se(n.objectId)).replace("{sessionId}",se(n.sessionId)).replace("{theme}",se(n.currentTheme)).replace("{meetingTitle}",se(n.meetingTitle))),frameContext:a.content,hostType:v.iframe,authenticationService:(t=e.client,{acquireToken:function(e){return t.query({query:oe,variables:{resource:e},fetchPolicy:"network-only"}).then(function(e){var t,n=e.data;return{token:null===(t=null==n?void 0:n.authenticationToken)||void 0===t?void 0:t.token}})},getUser:function(){return t.query({query:re,variables:{filter:{isAuthenticated:!0}}}).then(function(e){var t=e.data,n=e.errors,i=null==t?void 0:t.authenticationUsers;if(!n&&i&&0!==i.length){var a=i[0].profile;return{profile:{oid:a.objectId,tid:a.tenantId,upn:a.upn}}}})}}),messageHandlers:e.messageHandlers,appContext:o}))};le.displayName="CollaborativeWebContent",n.d(t,"default",function(){return le})}}]);